(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{392:function(s,t,a){},632:function(s,t,a){s.exports=a.p+"assets/img/31.8bb5a515.png"},633:function(s,t,a){s.exports=a.p+"assets/img/32.93f0654d.png"},634:function(s,t,a){s.exports=a.p+"assets/img/33.c3125223.png"},635:function(s,t,a){s.exports=a.p+"assets/img/34.eb752d3d.png"},636:function(s,t,a){"use strict";a(392)},774:function(s,t,a){"use strict";a.r(t);a(636);var n=a(37),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"场景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#场景"}},[s._v("#")]),s._v(" 场景")]),s._v(" "),n("p",[s._v("随着业务快速发展，除了CMS，CRM，直播后台，陆续研发新的后台业务，后台业务一多，就有两个问题：")]),s._v(" "),n("ol",[n("li",[s._v("后台登陆业务重复开发。")]),s._v(" "),n("li",[s._v("后台入口难找。接手的项目一多，每次都得找项目的链接。")])]),s._v(" "),n("h2",{attrs:{id:"实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实现"}},[s._v("#")]),s._v(" 实现")]),s._v(" "),n("p",[s._v("账密登陆 --\x3e 获取用户信息及"),n("code",[s._v("accessToken")]),s._v(" --\x3e 获取系统列表并展示(header的authorization字段值为accessToken) --\x3e 选择进入系统 --\x3e 系统入口链接带有用户信息及"),n("code",[s._v("accessToken")]),s._v("，接入的系统把用户信息及accessToken保存起来。")]),s._v(" "),n("div",[n("img",{staticStyle:{width:"30%"},attrs:{src:a(632)}}),s._v(" "),n("img",{staticStyle:{width:"68%"},attrs:{src:a(633)}})]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"systemId"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"desc"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SmartBI"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 系统名")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"imgUrl"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://img2.61info.cn/cms_new/homework/2020/4/9/1586426524573.png"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 图标")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"url"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://manager-test.61info.cn/#/cms/home?time=1634901225961&user=%7B%22userId%22%3A202706%2C%22accessToken%22%3A%22eyJhbGciOiJIUzI1NiJ9.eyJkYXRhIjoiWGcrY0NySlZ0eEg5N0FqQzVJUEV2bVhySFQ2YTY2T0cxVk5uTUdNK3R1Y2pVVU9nSTExQVRPaFZLU1N3VjhIb1VpRUh5WUp4SkRZNnBvendVRjIvYkNGQ0ZiRmhIM1JOR0VjR1RiOFl1SGN3SnBLLzBFRHBXRmVnMU1KcStGekVLejltSmR1Y3dPSXRJcmJvK3I2Q1lwNmtQUCtqRVlIQWdTVXl1UTBocVdiMDBRT0RHY0NzMGVHNzZsam1tN1BDb1RVRXRpL3VhcWZxT0Qxb3IxaktHbDhMeTA2YzZheldsM1RIcmRyQTJudz0iLCJleHAiOjE2NTA0NTMyMjV9.P-qCYx6tap39ixsWlu03KfYFhm4p8GdkcPaD4nuDxvI%22%2C%22accessTokenExpire%22%3A1650453225000%2C%22refreshToken%22%3A%22c00f9ba771638ac3af076753d918c0075152365f%22%2C%22refreshTokenExpire%22%3A1650453225000%2C%22name%22%3A%22%E5%BC%A0%E7%A8%8B%E4%BA%AE%22%2C%22phone%22%3A%2218822348321%22%2C%22systemId%22%3A4%7D"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("后台系统接一单点登陆")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 把accessToken和用户信息保存在本地")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这块逻辑可以抽离出来，给每个接入单点登陆的系统共用")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" params "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getParams")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" params"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 自动更新本地缓存")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("accessToken"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  localStorage"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setItem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'accessToken'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("accessToken"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  localStorage"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setItem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'loginInfo'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("stringify")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// axios")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("status "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("status "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("401")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Message")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("message")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'登录过期，即将跳转至统一登录界面'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'error'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("duration")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 回到单点登陆页")]),s._v("\n    window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("href "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OA_LOGIN_URL")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("h2",{attrs:{id:"jwt"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jwt"}},[s._v("#")]),s._v(" JWT")]),s._v(" "),n("p",[s._v("JWT由头部(Header), 负载(Payload)，签名(Signature)组成。alg属性表示签名的算法（algorithm），默认为"),n("code",[s._v("SHA256")]),s._v(" "),n("img",{attrs:{src:a(634),alt:"jwt"}})]),s._v(" "),n("ol",[n("li",[s._v("Header\nHeader 部分是一个 JSON 对象，通常是下面的样子")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"alg"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HS256"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"typ"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"JWT"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("Payload\nPayload 部分也是一个 JSON 对象，用来存放实际需要传递的数据。JWT 规定了7个官方字段，供选用")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("iss")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("issuer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：签发人\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("expiration time"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：过期时间\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sub")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("subject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：主题\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("aud")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("audience"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：受众\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("nbf")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Not Before"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：生效时间\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("iat")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Issued At"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：签发时间\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("jti")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JWT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ID")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("：编号\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("除了官方字段，你还可以在这个部分定义私有字段")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("Tips")]),s._v(" "),n("p",[s._v("Header, Payload对象，都是使用"),n("code",[s._v("Base64URL算法")]),s._v("转成字符串")])]),s._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[s._v("Signature\nSignature 部分是对前两部分的签名，防止数据篡改。\n服务器指定一个只有服务器才知道的密钥(secret), 使用Header里面指定的签名算法（默认SHA256)")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 按公式，生成Signature")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("HMACSHA256")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("base64UrlEncode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("header"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("base64UrlEncode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  secret\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("a",{attrs:{href:"https://www.box3.cn/tools/jwt.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("jwt在线解密"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("注意了，由于Header, Payload是使用"),n("a",{attrs:{href:"https://www.npmjs.com/package/base64url",target:"_blank",rel:"noopener noreferrer"}},[s._v("Base64URL"),n("OutboundLink")],1),s._v("算法加密的，而Base64URL是可以解密的。因此Header和Payload是可以解密的。")]),s._v(" "),n("p",[n("img",{attrs:{src:a(635),alt:"jwt"}})]),s._v(" "),n("h2",{attrs:{id:"面试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#面试"}},[s._v("#")]),s._v(" 面试")]),s._v(" "),n("p",[s._v("问：不同域名共享cookie")]),s._v(" "),n("p",[s._v("答：")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("挂在一个主域名下，那么子域名可以共享主域名的cookie.\n如：主域名："),n("code",[s._v(".61info.cn")]),s._v("  子域名："),n("code",[s._v("manager-test.61info.cn")]),s._v("和"),n("code",[s._v("sso-login-test.61info.cn")])])]),s._v(" "),n("li",[n("p",[s._v("添加cookie时设置domain。domain需要是当前域名的域名。本质原理还是子域名可以共享主域名的cookie\n如：在"),n("code",[s._v("https://manager-test.61info.cn/")]),s._v("域名下，添加cookie, domain为主域名61info.cn。则子域名实现cookie共享")])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// https://manager-test.61info.cn/ 域名下")]),s._v("\ndocument"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookie "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"example=zcl;domain=61info.cn"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("问：单点登陆的实现方法")]),s._v(" "),n("p",[s._v("答：\n单点登陆SSO：一次登陆，就可以访问多个系统")]),s._v(" "),n("ol",[n("li",[s._v("cookie共享（多个系统子域名相同）。登陆后把登陆信息(sessionId, token...)存在主域名的cookie中，子域名共享主域名的cookie，实现自动登陆。")]),s._v(" "),n("li",[s._v("url带登陆的token（多个系统域名不同）。sso界面登陆成功后跳到子应用时url带上token。子应用拿到token后，保存在本地(建议localstorage)。进入子应用时，通过本地的token实现自动登陆")])]),s._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844904034181070861#heading-18",target:"_blank",rel:"noopener noreferrer"}},[s._v("傻傻分不清之 Cookie、Session、Token、JWT"),n("OutboundLink")],1),s._v(" "),n("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("JSON Web Token 入门教程"),n("OutboundLink")],1),s._v(" "),n("a",{attrs:{href:"https://juejin.cn/post/6844903842773991431#heading-0",target:"_blank",rel:"noopener noreferrer"}},[s._v("你真的了解 Cookie 和 Session 吗"),n("OutboundLink")],1)])])}),[],!1,null,"37cb9817",null);t.default=e.exports}}]);