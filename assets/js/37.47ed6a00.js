(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{654:function(t,s,a){t.exports=a.p+"assets/img/5.2d531fc0.png"},655:function(t,s,a){t.exports=a.p+"assets/img/6.e490b3d4.png"},656:function(t,s){t.exports="data:image/png;base64,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"},783:function(t,s,a){"use strict";a.r(s);var n=a(37),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"工作流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#工作流程"}},[t._v("#")]),t._v(" 工作流程")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"app"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("fullName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" vm "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("el")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("firstName")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'first'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("lastName")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'last'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("computed")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算属性的 getter")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fullName")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// `this` 指向 vm 实例")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("firstName "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastName\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("Tips")]),t._v(" "),n("p",[t._v("温馨提示：computed 内使用的 data 属性，下文统称为“依赖属性”")])]),t._v(" "),n("p",[t._v("入口文件: /src/core/instance/index.js调用了"),n("code",[t._v("initMixin(Vue)")]),t._v("  -> /src/core/instance/init.js 调用了"),n("code",[t._v("initState(vm)")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 源码位置: /src/core/instance/state.js ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initState")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("vm")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Component")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_watchers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" opts "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$options\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initProps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("methods"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initMethods")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("methods"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* asRootData */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化 computed")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("computed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initComputed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("computed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("watch "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("watch "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" nativeWatch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initWatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br")])]),n("p",[t._v("initComputed")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 源码位置：/src/core/instance/state.js ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initComputed")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("vm")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("computed")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Object")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" watchers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_computedWatchers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" computed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" userDef "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" computed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" getter "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" userDef "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" userDef "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isSSR"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n      watchers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        getter "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("lazy")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineComputed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br")])]),n("ul",[n("li",[t._v("实例上定义 _computedWatchers 对象，用于存储“计算属性Watcher”")]),t._v(" "),n("li",[t._v("获取计算属性的 getter，需要判断是函数声明还是对象声明")]),t._v(" "),n("li",[t._v("创建"),n("code",[t._v("计算属性watcher")]),t._v("实例，getter 作为参数传入，它会在依赖属性更新时进行调用，并对计算属性重新取值。这部分下面会讲")]),t._v(" "),n("li",[t._v("defineComputed 对计算属性进行数据劫持")])]),t._v(" "),n("p",[t._v("defineComputed如何对计算属性做数据劫持?")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 源码位置：/src/core/instance/state.js ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("noop")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" sharedPropertyDefinition "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("enumerable")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("configurable")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" noop\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineComputed")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("target")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("key")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("userDef")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Object "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Function")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断是否为服务端渲染")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" shouldCache "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isServerRendering")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" userDef "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\n    sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shouldCache\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createComputedGetter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createGetterInvoker")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" noop\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\n    sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" shouldCache "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createComputedGetter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createGetterInvoker")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" noop\n    sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" noop\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n  Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br")])]),n("ol",[n("li",[t._v("sharedPropertyDefinition 是计算属性初始的属性描述对象")]),t._v(" "),n("li",[t._v("计算属性使用 "),n("code",[t._v("函数声明")]),t._v(" 或 "),n("code",[t._v("对象声明")]),t._v(", (浏览器环境)执行createComputedGetter返回的函数 赋值的 defineProperty.get")]),t._v(" "),n("li",[t._v("对计算属性进行数据劫持，sharedPropertyDefinition 作为第三个给参数传入")])]),t._v(" "),n("p",[t._v("下面看看 createComputedGetter 的实现")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 源码位置：/src/core/instance/state.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createComputedGetter")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("computedGetter")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" watcher "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_computedWatchers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_computedWatchers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("evaluate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("depend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br")])]),n("ol",[n("li",[t._v("取出对应的“计算属性Watcher")]),t._v(" "),n("li",[t._v("watcher.dirty 是实现计算属性缓存的触发点，当watcher.dirty为true时, 才会执行watcher.evaluate 对计算属性重新求值")]),t._v(" "),n("li",[t._v("依赖属性收集"),n("code",[t._v("渲染watcher")]),t._v("\n第3点, 为什么依赖属性收集 render watcher? 这个下面会解释")])]),t._v(" "),n("h2",{attrs:{id:"computed缓存"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#computed缓存"}},[t._v("#")]),t._v(" computed缓存")]),t._v(" "),n("p",[t._v("在创建 computed watcher 的时候, lazy为true, dirty 的初始值等同于 lazy")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    getter "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("lazy")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])]),n("p",[t._v("也就是说, 在初始化computed中, 会实例化computed watcher, 实例化后的computed watcher 的lazy属性为true, 所以此时watcher.value 为 undefined")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("vm")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("expOrFn")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Function"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("cb")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Function"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    options"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    isRenderWatcher"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ......")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dirty 初始值等同于 lazy")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirty "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// for lazy watchers")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br")])]),n("p",[t._v("初始化computed结束后, 会执行$mount, 初始化渲染界面. 以文章开头的例子, 初始化渲染界面时, 由于使用到了"),n("code",[t._v("fullname")]),t._v(", 触发 computed "),n("code",[t._v("数据劫持get")]),t._v(". 前面已经讲过, 计算属性进行数据劫持get 实际上是 执行computedGetter函数.")]),t._v(" "),n("h2",{attrs:{id:"核心代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#核心代码"}},[t._v("#")]),t._v(" 核心代码")]),t._v(" "),n("p",[t._v("再来看下核心代码吧!")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createComputedGetter")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("computedGetter")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" watcher "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_computedWatchers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_computedWatchers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("evaluate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("depend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// .....")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("evaluate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirty "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br")])]),n("p",[t._v("执行computedGetter函数, 由于实例化的computed watcher.dirty为true, 所以会执行watcher.evaluate(), evaluate做了两件事")]),t._v(" "),n("ul",[n("li",[t._v("调用this.get(), 即执行computed函数, 将结果赋值给watcher.value")]),t._v(" "),n("li",[t._v("将watcher.dirty 置为 false. 下次再获取计算属性时, 就无需再次执行evaluate, 只需直接返回缓存的watcher.value.")])]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("Tips")]),t._v(" "),n("p",[t._v("虽然watcher.dirty置为 false, 但watcher.lazy 还是 true")])]),t._v(" "),n("h2",{attrs:{id:"依赖收集"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#依赖收集"}},[t._v("#")]),t._v(" 依赖收集")]),t._v(" "),n("p",[t._v("上面讲了, 为了将结果缓存到watcher.value, 需要调用this.get(), 即执行computed函数. 然而执行computed函数时, 可不是那么简单! computed函数会获取 "),n("code",[t._v("依赖属性")]),t._v(", 触发 数据劫持get. 那么初始化渲染界面后, computed 依赖属性 对应的 dep队列 有几个watcher? 分别是什么? 下面我们来分析一下")]),t._v(" "),n("p",[t._v("想搞清楚依赖收集, 必须要知道Dep.target(即watcher实例), dep分别是啥! 才能把watcher实例放入属性对应的dep队列中.")]),t._v(" "),n("h3",{attrs:{id:"收集计算属性watcher"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#收集计算属性watcher"}},[t._v("#")]),t._v(" 收集计算属性Watcher")]),t._v(" "),n("p",[t._v("其实this.get()函数中, 调用pushTarget()就把当前的watcher入栈, 并赋值给Dep.target.")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" stack "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 存储 watcher 的栈")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushTarget")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("watcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 入栈")]),t._v("\n  stack"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" watcher\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("popTarget")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 出栈")]),t._v("\n  stack"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pop")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" stack"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("stack"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br")])]),n("p",[t._v("在界面初始化时, 具体来说是$beforeMount之后, $mounted之前, 会实例化 "),n("code",[t._v("渲染watcher")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mountComponent")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  hydrating")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'beforeMount'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" updateComponent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("updateComponent")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 渲染页面")]),t._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_update")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_render")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hydrating"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" updateComponent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("before")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("before")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_isMounted "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_isDestroyed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'beforeUpdate'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* isRenderWatcher */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  hydrating "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$vnode "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_isMounted "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mounted'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" vm\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br")])]),n("p",[t._v("此时, 先将"),n("code",[t._v("渲染watcher")]),t._v("入栈, 并赋值给"),n("code",[t._v("Dep.target")]),t._v("\n在页面渲染过程中遇到计算属性，对其取值，因此执行 watcher.evaluate 的逻辑，接着调用 this.get")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushTarget")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" value\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vm "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vm\n  value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算属性求值")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("popTarget")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cleanupDeps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" value\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br")])]),n("p",[t._v("pushTarget 轮到“计算属性Watcher”入栈，并挂载到Dep.target，此时"),n("strong",[t._v("栈中为 [渲染Watcher, 计算属性Watcher]")])]),t._v(" "),n("p",[t._v("this.getter 对计算属性求值，在获取依赖属性时，会触发依赖属性的 "),n("code",[t._v("数据劫持get")]),t._v("，执行 dep.depend 收集依赖（“计算属性Watcher”）, 此时"),n("code",[t._v("依赖属性 对应的dep队列 [计算属性Watcher]")])]),t._v(" "),n("h3",{attrs:{id:"收集渲染watcher"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#收集渲染watcher"}},[t._v("#")]),t._v(" 收集渲染Watcher")]),t._v(" "),n("p",[t._v("this.getter 求值完成执行"),n("code",[t._v("popTragte")]),t._v("，“计算属性Watcher”出栈，Dep.target 设置为“渲染Watcher”，此时的 Dep.target 是“渲染Watcher”\n在核心代码中, 有如下代码:")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("depend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("p",[t._v("watcher.depend 将 当前watcher, 即Dep.target, 即渲染watcher. 放入依赖属性的 dep队列中. 此时"),n("code",[t._v("依赖属性 对应的dep队列 [计算属性Watcher, 渲染watcher]")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("depend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// deps 内存储的是依赖属性的 dep")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("deps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("deps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("depend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br")])]),n("p",[n("img",{attrs:{src:a(654),alt:"deps"}})]),t._v(" "),n("h3",{attrs:{id:"为什么依赖属性要收集渲染watcher"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么依赖属性要收集渲染watcher"}},[t._v("#")]),t._v(" 为什么依赖属性要收集渲染Watcher")]),t._v(" "),n("p",[t._v("模板上没有使用到依赖属性，页面渲染时，那么依赖属性是不会收集 “渲染Watcher”的。此时依赖属性里只会有“计算属性Watcher”，当依赖属性被修改，只会触发“计算属性Watcher”的 update。而计算属性的 update 里仅仅是将 dirty 设置为 true，并没有立刻求值，那么计算属性也不会被更新。")]),t._v(" "),n("p",[t._v("所以需要收集“渲染Watcher”，在执行完“计算属性Watcher”后，再执行“渲染Watcher”。页面渲染对计算属性取值，执行 watcher.evaluate 才会重新计算求值，页面计算属性更新")]),t._v(" "),n("h2",{attrs:{id:"依赖依集总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#依赖依集总结"}},[t._v("#")]),t._v(" 依赖依集总结")]),t._v(" "),n("p",[n("img",{attrs:{src:a(655),alt:"deps"}})]),t._v(" "),n("p",[t._v("依赖属性的dep队列至少会有两个watcher[计算属性Watcher, 渲染watcher]")]),t._v(" "),n("h2",{attrs:{id:"面试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#面试"}},[t._v("#")]),t._v(" 面试")]),t._v(" "),n("ol",[n("li",[t._v("computed是如何初始化的, 初始化之后做了那些事情?")])]),t._v(" "),n("p",[t._v("答:")]),t._v(" "),n("ul",[n("li",[t._v("实例化computed watcher, 将computed watcher存入vm._computedWatchers 对象中. 初始化时watcher.dirty为true")]),t._v(" "),n("li",[t._v("通过defineProperty 对computed属性 做数据劫持")]),t._v(" "),n("li",[t._v("界面渲染时, 获取computed属性, 触发数据劫持get, 由于watcher.dirty为true, 会执行computed函数")])]),t._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[t._v("为什么我们改变了data中的属性值后, computed会重新计算, 它是如何实现的?\n修改了依赖属性, computed会重新计算.\n依赖收集:")])]),t._v(" "),n("ul",[n("li",[t._v("依赖属性对应的dep队列[计算属性Watcher]. 页面渲染获取computed属性时, 会执行computed函数. 触发了依赖属性 数据劫持get, 将computed watcher 放入 依赖属性对应的dep队列")]),t._v(" "),n("li",[t._v("依赖属性对应的dep队列[计算属性Watcher, 渲染watcher]. computed中执行watcher.depend. 将渲染watcher放入 依赖属性的dep队列\n总之, computed在页面渲染之后, 依赖属性的dep队列至少会有两个watcher[计算属性Watcher, 渲染watcher]")])]),t._v(" "),n("p",[t._v("当依赖属性变化时, 先执行计算属性Watcher 的update, 将watcher.dirty置为true, 表示需要重新计算.  接着执行渲染watcher 的update回调, 页面渲染对computed 属性取值, 由于computed watcher.dirty为true, 会执行computed watcher.evaluate重新计算求值\n"),n("img",{attrs:{src:a(656),alt:"dirty"}})]),t._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[t._v("computed它是如何缓存值的, 当我们下次访问该属性的时候, 是怎样读取缓存数据的?\n通过computed watcher.dirty控制是否使用缓存")])]),t._v(" "),n("p",[t._v("将缓存结果赋值给 computed watcher.value")]),t._v(" "),n("ul",[n("li",[t._v("dirty为true: 重新计算, 更新watcher.value")]),t._v(" "),n("li",[t._v("dirty为false: 使用缓存, 直接返回")])]),t._v(" "),n("p",[t._v("参考:\n"),n("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MzUxNjQ1NjMwNw==&mid=2247484234&idx=1&sn=70a9dea79d5f1b5aaacbe828fa5815e1&chksm=f9a66956ced1e0407f5ac7a3722f9784327b121763e73de9011b4fcb852d530d44632717021c&cur_album_id=1619085427984957440&scene=190#rd",target:"_blank",rel:"noopener noreferrer"}},[t._v("Computed - 源码版"),n("OutboundLink")],1),t._v(" "),n("a",{attrs:{href:"https://www.cnblogs.com/chanwahfung/p/13193897.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("手摸手带你理解Vue的Computed原理"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);