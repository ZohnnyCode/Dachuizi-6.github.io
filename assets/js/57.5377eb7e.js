(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{674:function(t,e,s){t.exports=s.p+"assets/img/15.f755228f.png"},675:function(t,e,s){t.exports=s.p+"assets/img/14.37b9b0c3.png"},793:function(t,e,s){"use strict";s.r(e);var a=s(37),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"为什么需要服务端渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要服务端渲染"}},[t._v("#")]),t._v(" 为什么需要服务端渲染")]),t._v(" "),a("p",[t._v("常规的Vue的SPA项目，界面是通过js动态渲染出来的。这样会有两个问题：")]),t._v(" "),a("ul",[a("li",[t._v("无法SEO。界面只有根标签，爬虫无法抓取其它元素")]),t._v(" "),a("li",[t._v("首屏白屏问题。界面是通过JS渲染出来的，如果JS文件体积很大，需要下载一段时间，那在这一段时间浏览器界面是空白的。")])]),t._v(" "),a("h2",{attrs:{id:"什么是服务端渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是服务端渲染"}},[t._v("#")]),t._v(" 什么是服务端渲染")]),t._v(" "),a("p",[t._v("在服务端获取到用户浏览器输入的路由，服务器会提前获取首屏所需求的数据，并注入到HTML中，将渲染好的html字符串，返回给浏览器。data-server-rendered 特殊属性，让客户端 Vue 知道这部分 HTML 是由 Vue 在服务端渲染的，并且应该以激活模式进行挂载。使用界面激活为可交互的应用程序。\n"),a("img",{attrs:{src:s(674),alt:"ssr"}})]),t._v(" "),a("h2",{attrs:{id:"服务器端渲染有哪些缺点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器端渲染有哪些缺点"}},[t._v("#")]),t._v(" 服务器端渲染有哪些缺点")]),t._v(" "),a("ul",[a("li",[t._v("服务器端负载。在 Node.js 中渲染完整的应用程序，显然会比仅仅提供静态文件的 server 更加大量占用 CPU 资源 (CPU-intensive - CPU 密集)")]),t._v(" "),a("li",[t._v("开发难度增加、项目的构建、配置、部署。需要懂node技术、区别客户端、服务端分别进行配置及部署；开发中也需要及时注意内存问题、及服务器压力。需要的能力更为综合。")]),t._v(" "),a("li",[t._v("开发条件所限。除beforeCreate、Create 生命周期外服务端都不执行，window、document不存在。[一些外部扩展库可能需要特殊处理，才能在服务器渲染应用程序中运行]")])]),t._v(" "),a("h2",{attrs:{id:"服务器端渲染如何实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器端渲染如何实现"}},[t._v("#")]),t._v(" 服务器端渲染如何实现")]),t._v(" "),a("p",[t._v("要解决两个问题：服务端首屏渲染和客户端激活")]),t._v(" "),a("ul",[a("li",[t._v("服务器bundle文件：用于服务端首屏渲染")]),t._v(" "),a("li",[t._v("客户端bundle文件：也会发送给浏览器，用于客户端激活")])]),t._v(" "),a("p",[a("img",{attrs:{src:s(675),alt:"ssr"}})]),t._v(" "),a("p",[t._v("如图所示 有两个入口文件，Server entry 和Client entry,分别经webpack打包成服务端用的Server Bundle和客户端用的Client Bundle。")]),t._v(" "),a("ol",[a("li",[t._v("服务端：当Node Server收到来自客户端的请求后，BundleRenderer 会读取Server Bundle，并且执行它，而Server Bundle实现了数据读取并将填充数据的Vue实例挂载在HTML模板上，接下来BundleRenderer将HTML渲染为字符串，最后将完整的HTML返回给客户端。")]),t._v(" "),a("li",[t._v("客户端： 浏览器收到HTML后，客户端加载了Client Bundle,通过app.$mount('#app')的方式将Vue实例挂载在服务端返回的静态HTML上。如：")])]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("data-server-rendered")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("客户端激活：data-server-rendered特殊属性，让客户端Vue知道这部分HTML是由Vue在服务端渲染的，并且应该以激活模式Hydartion模式挂载。")])]),t._v(" "),a("p",[t._v("参考：\nhttps://github.com/zyl1314/vue-ssr-demo/issues/2\nhttps://github.com/leocoder351/vue-ssr-demo\nhttps://segmentfault.com/a/1190000016637877")])])}),[],!1,null,null,null);e.default=r.exports}}]);