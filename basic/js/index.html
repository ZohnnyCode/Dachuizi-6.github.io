<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>变量提升 | Zohnny前端小册</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Zohnny前端小册">
    
    <link rel="preload" href="/assets/css/0.styles.9a0b0289.css" as="style"><link rel="preload" href="/assets/js/app.e8c3aa62.js" as="script"><link rel="preload" href="/assets/js/2.1d5e0d04.js" as="script"><link rel="preload" href="/assets/js/4.c29c9b60.js" as="script"><link rel="prefetch" href="/assets/js/10.0bc17075.js"><link rel="prefetch" href="/assets/js/100.194dcfa0.js"><link rel="prefetch" href="/assets/js/101.f8977d49.js"><link rel="prefetch" href="/assets/js/102.68d460f2.js"><link rel="prefetch" href="/assets/js/103.3ac580e7.js"><link rel="prefetch" href="/assets/js/104.9d4751c7.js"><link rel="prefetch" href="/assets/js/105.a5f0c700.js"><link rel="prefetch" href="/assets/js/106.e56dcf3c.js"><link rel="prefetch" href="/assets/js/107.1f1c30b4.js"><link rel="prefetch" href="/assets/js/108.68ca0fc6.js"><link rel="prefetch" href="/assets/js/109.50ce68c2.js"><link rel="prefetch" href="/assets/js/11.979bcc85.js"><link rel="prefetch" href="/assets/js/110.f56975a0.js"><link rel="prefetch" href="/assets/js/111.52d900c7.js"><link rel="prefetch" href="/assets/js/112.00424531.js"><link rel="prefetch" href="/assets/js/113.ea237985.js"><link rel="prefetch" href="/assets/js/114.57f07f83.js"><link rel="prefetch" href="/assets/js/115.ec061508.js"><link rel="prefetch" href="/assets/js/116.944ac05b.js"><link rel="prefetch" href="/assets/js/117.51a3bd3d.js"><link rel="prefetch" href="/assets/js/118.b1708a32.js"><link rel="prefetch" href="/assets/js/119.547f729e.js"><link rel="prefetch" href="/assets/js/12.f7837a85.js"><link rel="prefetch" href="/assets/js/120.77b77710.js"><link rel="prefetch" href="/assets/js/121.a6f28bc6.js"><link rel="prefetch" href="/assets/js/13.8e015820.js"><link rel="prefetch" href="/assets/js/14.34a558be.js"><link rel="prefetch" href="/assets/js/15.60fac476.js"><link rel="prefetch" href="/assets/js/16.be05c3ca.js"><link rel="prefetch" href="/assets/js/17.f8c4932c.js"><link rel="prefetch" href="/assets/js/18.5e0519af.js"><link rel="prefetch" href="/assets/js/19.db909a84.js"><link rel="prefetch" href="/assets/js/20.8cc2df06.js"><link rel="prefetch" href="/assets/js/21.f4b0b435.js"><link rel="prefetch" href="/assets/js/22.d559c9b3.js"><link rel="prefetch" href="/assets/js/23.74ba9f22.js"><link rel="prefetch" href="/assets/js/24.2a4117e9.js"><link rel="prefetch" href="/assets/js/25.73c08c20.js"><link rel="prefetch" href="/assets/js/26.c19cc994.js"><link rel="prefetch" href="/assets/js/27.81cd809b.js"><link rel="prefetch" href="/assets/js/28.6791b309.js"><link rel="prefetch" href="/assets/js/29.391ab5ba.js"><link rel="prefetch" href="/assets/js/3.1efbb513.js"><link rel="prefetch" href="/assets/js/30.0b1d7a71.js"><link rel="prefetch" href="/assets/js/31.1f2bb083.js"><link rel="prefetch" href="/assets/js/32.cae2775b.js"><link rel="prefetch" href="/assets/js/33.1e9405be.js"><link rel="prefetch" href="/assets/js/34.9210faf9.js"><link rel="prefetch" href="/assets/js/35.2ac222fd.js"><link rel="prefetch" href="/assets/js/36.c1aa7d10.js"><link rel="prefetch" href="/assets/js/37.47ed6a00.js"><link rel="prefetch" href="/assets/js/38.0743fb65.js"><link rel="prefetch" href="/assets/js/39.f1abc33e.js"><link rel="prefetch" href="/assets/js/40.4c2c9b8b.js"><link rel="prefetch" href="/assets/js/41.f38fd71e.js"><link rel="prefetch" href="/assets/js/42.59cc5e7a.js"><link rel="prefetch" href="/assets/js/43.54713365.js"><link rel="prefetch" href="/assets/js/44.cc7cdb87.js"><link rel="prefetch" href="/assets/js/45.cdc6ea0c.js"><link rel="prefetch" href="/assets/js/46.2ab8048b.js"><link rel="prefetch" href="/assets/js/47.f6a00ea3.js"><link rel="prefetch" href="/assets/js/48.8349de8f.js"><link rel="prefetch" href="/assets/js/49.98c2ddda.js"><link rel="prefetch" href="/assets/js/5.40944f1c.js"><link rel="prefetch" href="/assets/js/50.425c325b.js"><link rel="prefetch" href="/assets/js/51.b4870e91.js"><link rel="prefetch" href="/assets/js/52.aef0d698.js"><link rel="prefetch" href="/assets/js/53.e07d00ac.js"><link rel="prefetch" href="/assets/js/54.b7687687.js"><link rel="prefetch" href="/assets/js/55.65cf97ed.js"><link rel="prefetch" href="/assets/js/56.3444efc3.js"><link rel="prefetch" href="/assets/js/57.5377eb7e.js"><link rel="prefetch" href="/assets/js/58.e5099448.js"><link rel="prefetch" href="/assets/js/59.d09bc881.js"><link rel="prefetch" href="/assets/js/6.732df0ed.js"><link rel="prefetch" href="/assets/js/60.eba8f995.js"><link rel="prefetch" href="/assets/js/61.bd8ab09f.js"><link rel="prefetch" href="/assets/js/62.0bd4e7fc.js"><link rel="prefetch" href="/assets/js/63.640df805.js"><link rel="prefetch" href="/assets/js/64.35c8b8f7.js"><link rel="prefetch" href="/assets/js/65.affde9cb.js"><link rel="prefetch" href="/assets/js/66.9f8cabb6.js"><link rel="prefetch" href="/assets/js/67.00890bbe.js"><link rel="prefetch" href="/assets/js/68.0936ba21.js"><link rel="prefetch" href="/assets/js/69.a33cdaf9.js"><link rel="prefetch" href="/assets/js/7.31bb07dc.js"><link rel="prefetch" href="/assets/js/70.1df3e127.js"><link rel="prefetch" href="/assets/js/71.f4124ef5.js"><link rel="prefetch" href="/assets/js/72.01e6c977.js"><link rel="prefetch" href="/assets/js/73.b07f15a4.js"><link rel="prefetch" href="/assets/js/74.f72cdef2.js"><link rel="prefetch" href="/assets/js/75.ee885b7d.js"><link rel="prefetch" href="/assets/js/76.84c918df.js"><link rel="prefetch" href="/assets/js/77.a28fd7f5.js"><link rel="prefetch" href="/assets/js/78.482bfb70.js"><link rel="prefetch" href="/assets/js/79.091c9dbf.js"><link rel="prefetch" href="/assets/js/8.c0da64f7.js"><link rel="prefetch" href="/assets/js/80.df33fddc.js"><link rel="prefetch" href="/assets/js/81.6e6db080.js"><link rel="prefetch" href="/assets/js/82.e9138597.js"><link rel="prefetch" href="/assets/js/83.31c363ff.js"><link rel="prefetch" href="/assets/js/84.1e1be0f3.js"><link rel="prefetch" href="/assets/js/85.c861f43f.js"><link rel="prefetch" href="/assets/js/86.5a205712.js"><link rel="prefetch" href="/assets/js/87.d9dc3fb3.js"><link rel="prefetch" href="/assets/js/88.4297aa82.js"><link rel="prefetch" href="/assets/js/89.0a4430b5.js"><link rel="prefetch" href="/assets/js/9.0c30cda9.js"><link rel="prefetch" href="/assets/js/90.c95ae974.js"><link rel="prefetch" href="/assets/js/91.ff322a2a.js"><link rel="prefetch" href="/assets/js/92.6272aacc.js"><link rel="prefetch" href="/assets/js/93.f34792ac.js"><link rel="prefetch" href="/assets/js/94.5cd9fa78.js"><link rel="prefetch" href="/assets/js/95.4c0963b8.js"><link rel="prefetch" href="/assets/js/96.4b8520b9.js"><link rel="prefetch" href="/assets/js/97.cdf1abbd.js"><link rel="prefetch" href="/assets/js/98.4d55767c.js"><link rel="prefetch" href="/assets/js/99.0a1d65d6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9a0b0289.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Zohnny前端小册</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/basic/basic/" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/css/" class="nav-link">
  css
</a></div><div class="nav-item"><a href="/browser/theory/" class="nav-link">
  浏览器相关
</a></div><div class="nav-item"><a href="/nodejs/" class="nav-link">
  nodejs
</a></div><div class="nav-item"><a href="/babel/" class="nav-link">
  babel
</a></div><div class="nav-item"><a href="/buildTools/webpack/" class="nav-link">
  打包工具
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/reactive/" class="nav-link">
  响应式
</a></li><li class="dropdown-item"><!----> <a href="/vue/compiler/" class="nav-link">
  模版编译
</a></li><li class="dropdown-item"><!----> <a href="/vue/vnode/" class="nav-link">
  虚拟DOM
</a></li><li class="dropdown-item"><!----> <a href="/vue/whole-process/" class="nav-link">
  整体流程
</a></li><li class="dropdown-item"><!----> <a href="/vue/vuex/" class="nav-link">
  Vuex&amp;Vue-router
</a></li></ul></div></div><div class="nav-item"><a href="/mobile/" class="nav-link">
  移动端
</a></div><div class="nav-item"><a href="/code-reviews/" class="nav-link">
  LC
</a></div><div class="nav-item"><a href="/project/B/batch_download.html" class="nav-link">
  项目
</a></div><div class="nav-item"><a href="/news/vue3.html" class="nav-link">
  前沿
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://0zcl.github.io/utils-library/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  公共函数库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://0zcl.github.io/h5-sdk/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  h5-sdk
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/0zcl/h5_template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  移动端多页面模版
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/0zcl/zcl-mobile-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  移动端组件库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://gitlab.61info.com:8190/zcl/tpc-cli" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zcl脚手架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/Dachuizi-6" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/basic/basic/" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/css/" class="nav-link">
  css
</a></div><div class="nav-item"><a href="/browser/theory/" class="nav-link">
  浏览器相关
</a></div><div class="nav-item"><a href="/nodejs/" class="nav-link">
  nodejs
</a></div><div class="nav-item"><a href="/babel/" class="nav-link">
  babel
</a></div><div class="nav-item"><a href="/buildTools/webpack/" class="nav-link">
  打包工具
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/reactive/" class="nav-link">
  响应式
</a></li><li class="dropdown-item"><!----> <a href="/vue/compiler/" class="nav-link">
  模版编译
</a></li><li class="dropdown-item"><!----> <a href="/vue/vnode/" class="nav-link">
  虚拟DOM
</a></li><li class="dropdown-item"><!----> <a href="/vue/whole-process/" class="nav-link">
  整体流程
</a></li><li class="dropdown-item"><!----> <a href="/vue/vuex/" class="nav-link">
  Vuex&amp;Vue-router
</a></li></ul></div></div><div class="nav-item"><a href="/mobile/" class="nav-link">
  移动端
</a></div><div class="nav-item"><a href="/code-reviews/" class="nav-link">
  LC
</a></div><div class="nav-item"><a href="/project/B/batch_download.html" class="nav-link">
  项目
</a></div><div class="nav-item"><a href="/news/vue3.html" class="nav-link">
  前沿
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://0zcl.github.io/utils-library/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  公共函数库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://0zcl.github.io/h5-sdk/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  h5-sdk
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/0zcl/h5_template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  移动端多页面模版
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/0zcl/zcl-mobile-ui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  移动端组件库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://gitlab.61info.com:8190/zcl/tpc-cli" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zcl脚手架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/Dachuizi-6" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>手写代码</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JS底层深入</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/basic/js/" aria-current="page" class="active sidebar-link">JS底层</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/basic/js/#变量提升" class="sidebar-link">变量提升</a></li><li class="sidebar-sub-header"><a href="/basic/js/#执行上下文与变量环境" class="sidebar-link">执行上下文与变量环境</a></li><li class="sidebar-sub-header"><a href="/basic/js/#考一考" class="sidebar-link">考一考</a></li><li class="sidebar-sub-header"><a href="/basic/js/#为什么-js-代码会出现栈溢出" class="sidebar-link">为什么 JS 代码会出现栈溢出？</a></li><li class="sidebar-sub-header"><a href="/basic/js/#var缺陷以及如何解决" class="sidebar-link">var缺陷以及如何解决？</a></li><li class="sidebar-sub-header"><a href="/basic/js/#块级作用域与词法环境" class="sidebar-link">块级作用域与词法环境</a></li><li class="sidebar-sub-header"><a href="/basic/js/#作用域链与词法作用域" class="sidebar-link">作用域链与词法作用域</a></li><li class="sidebar-sub-header"><a href="/basic/js/#闭包【重要】" class="sidebar-link">闭包【重要】</a></li><li class="sidebar-sub-header"><a href="/basic/js/#this的设计缺陷及应对方案" class="sidebar-link">this的设计缺陷及应对方案</a></li><li class="sidebar-sub-header"><a href="/basic/js/#考一考-2" class="sidebar-link">考一考</a></li><li class="sidebar-sub-header"><a href="/basic/js/#垃圾数据是如何自动回收的" class="sidebar-link">垃圾数据是如何自动回收的</a></li><li class="sidebar-sub-header"><a href="/basic/js/#描述一下-v8-执行一段js代码的过程" class="sidebar-link">描述一下 V8 执行一段JS代码的过程</a></li><li class="sidebar-sub-header"><a href="/basic/js/#考一考-3" class="sidebar-link">考一考</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="变量提升"><a href="#变量提升" class="header-anchor">#</a> 变量提升</h2> <p>JS 引擎把变量的声明部分和函数声明部分 提升到代码开头的行为。变量被提升后，会给变量设置默认值： undefined</p> <p>实际上变量和函数声明在代码里的位置是不会改变的，而且是在<code>编译阶段</code>被 JS 引擎放入内存中</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myname<span class="token punctuation">)</span>
<span class="token keyword">var</span> myname <span class="token operator">=</span> <span class="token string">'极客时间'</span>
<span class="token keyword">function</span> <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'函数showName被执行'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 测试</span>
<span class="token comment">// 函数showName被执行</span>
<span class="token comment">// undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="/assets/img/1.30f1bc92.png" alt="hoisting"></p> <h2 id="执行上下文与变量环境"><a href="#执行上下文与变量环境" class="header-anchor">#</a> 执行上下文与变量环境</h2> <p>输入一段代码，经过编译，生成两部分</p> <ol><li>执行上下文。变量和函数会被存放到<code>变量环境</code>中</li> <li>可执行代码</li></ol> <h2 id="考一考"><a href="#考一考" class="header-anchor">#</a> 考一考</h2> <div class="custom-block warning"><p class="custom-block-title">Note</p> <p>执行下面代码，打印出啥？</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> <span class="token function-variable function">showName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div> <p>答：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>编译过程：
<span class="token keyword">var</span> showName <span class="token operator">=</span> <span class="token keyword">undefined</span>
<span class="token keyword">function</span> <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
执行阶段：
<span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 输出1</span>
<span class="token function-variable function">showName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 输出2</span>
<span class="token comment">// 如果后面再有showName执行的话，就输出2因为这时候函数引用已经变了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>变量提升和函数提升的优先级，函数提升高于变量提升，<strong>当存在同名时，在变量赋值之前函数声明还是函数声明，不会被覆盖</strong>，当变量赋值之后，函数声明将被变量覆盖。<a href="https://zhuanlan.zhihu.com/p/364416036" target="_blank" rel="noopener noreferrer">JavaScript变量提升和函数提升<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="为什么-js-代码会出现栈溢出"><a href="#为什么-js-代码会出现栈溢出" class="header-anchor">#</a> 为什么 JS 代码会出现栈溢出？</h2> <p>每调用一个函数，JS引擎为其创建<code>执行上下文</code>，并压入栈中，而调用栈是有大小的，当栈的执行上下文超过一定数量时，就会出现<code>栈溢出</code>。</p> <img src="/assets/img/2.51773ab2.png" style="width:50%;"> <h2 id="var缺陷以及如何解决"><a href="#var缺陷以及如何解决" class="header-anchor">#</a> var缺陷以及如何解决？</h2> <p>var缺陷：</p> <ol><li>变量提升</li> <li>污染全局变量</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">7</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 7</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>解决var缺陷：
ES6引入 <code>let</code> 和 <code>const</code> 关键字, 使其拥有<code>块级作用域</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">letTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment">// 不同的变量</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 2</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 1</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="块级作用域与词法环境"><a href="#块级作用域与词法环境" class="header-anchor">#</a> 块级作用域与词法环境</h2> <p>在编译阶段，通过 var 声明的变量放到了<code>变量环境</code>中，通过 let、const 声明的变量放到了<code>词法环境</code>中</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">3</span>
    <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">4</span>
    <span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token number">5</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 1</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// 3</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// 2</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token comment">// 4</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token comment">// 出错</span>
<span class="token punctuation">}</span>   
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><img src="/assets/img/3.833ebea1.png" style="width:60%;"> <img src="/assets/img/4.6d2bb189.png" style="width:39%;"> <ol><li>词法环境中也维护了一个栈结构，栈底是函数最外层的变量</li> <li>沿着词法环境的栈顶向下查询，如果没找到，在变量环境中查找</li> <li>当<code>作用域</code>执行结束后，该作用域的信息就会从栈顶弹出</li></ol> <h2 id="作用域链与词法作用域"><a href="#作用域链与词法作用域" class="header-anchor">#</a> 作用域链与词法作用域</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myName<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> myName <span class="token operator">=</span> <span class="token string">&quot;极客邦&quot;</span>
  <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> myName <span class="token operator">=</span> <span class="token string">&quot;极客时间&quot;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 极客时间</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>在每个<code>执行上下文的变量环境</code>中，都包含了一个<code>外部引用</code>，用来<strong>指向外部的执行上下文</strong>，我们把这个外部引用称为<code>outer</code></p> <p>当使用了一个变量时，js 引擎首先在当前上下文中查找，找不到就继续在outer指向的上下文中查找。这个查找的链条就作用域链</p> <p><img src="/assets/img/5.e8b33b51.png" alt="outer"></p> <p>问：foo 函数调用的 bar 函数，那为什么 bar 函数的外部引用是全局执行上下文，而不是 foo 函数的执行上下文？</p> <p>答：JS的作用域链是由<code>词法作用域</code>决定的，词法作用域又由代码中函数声明的位置来决定的。词法作用域是代码编译阶段就决定好的，和函数怎么调用没有关系。</p> <h2 id="闭包【重要】"><a href="#闭包【重要】" class="header-anchor">#</a> 闭包【重要】</h2> <p>定义：在JS中，根据词法作用域的规则，内部函数总是可以访问其外部函数声明的变量。当通过调用一个<code>外部函数</code>返回一个<code>内部函数</code>后，即使外部函数已经执行结束了，但由于存在内部函数对外部函数变量的引用，因此这些变量依然保存在内存中，<code>变量的集合就称为闭包</code></p> <p><img src="/assets/img/6.c6bc91fe.png" alt="closure"></p> <p>闭包如何回收？</p> <ul><li>引用闭包的函数是一个全局变量：闭包会一直存在直到页面关闭。</li> <li>引用闭包的函数是一个局部变量：函数销毁后，在下次 JavaScript 引擎执行垃圾回收时，判断闭包这块内容如果已经不再被使用了，那么 JavaScript 引擎的垃圾回收器就会回收这块内存</li></ul> <div class="custom-block tip"><p class="custom-block-title">Tips</p> <ol><li>闭包不会造成内存泄漏。闭包可能会常驻在内存中。程序写错了才会造成内存泄漏</li> <li>如果该闭包会一直使用，那么它可以作为全局变量而存在；但如果使用频率不高，而且占用内存又比较大的话，那就尽量让它成为一个局部变量</li></ol></div> <h2 id="this的设计缺陷及应对方案"><a href="#this的设计缺陷及应对方案" class="header-anchor">#</a> this的设计缺陷及应对方案</h2> <p>执行上下文中包含了<code>变量环境</code>、<code>词法环境</code>、<code>外部环境</code>和<code>this</code></p> <img src="/assets/img/7.70c3b8d1.png" style="width:40%;"> <ol><li>嵌套函数中的 this 不会从外层函数中继承</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> myObj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span> <span class="token operator">:</span> <span class="token string">&quot;极客时间&quot;</span><span class="token punctuation">,</span> 
  <span class="token function-variable function">showThis</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// {name: &quot;极客时间&quot;, showThis: ƒ}</span>
    <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token comment">// window</span>
    <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
myObj<span class="token punctuation">.</span><span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>self=this</li> <li>箭头函数: 箭头函数没有自己的执行上下文，所以它会继承调用函数中的 this</li></ul> <ol start="2"><li>普通函数中的 this 默认指向全局对象 window</li></ol> <ul><li>在严格模式下，默认执行一个函数，其函数的执行上下文中的 this 值是 undefined</li></ul> <h2 id="考一考-2"><a href="#考一考-2" class="header-anchor">#</a> 考一考</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> userInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;jack.ma&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">13</span><span class="token punctuation">,</span>
  <span class="token literal-property property">sex</span><span class="token operator">:</span>male<span class="token punctuation">,</span>
  <span class="token function-variable function">updateInfo</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;pony.ma&quot;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">39</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> female
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
userInfo<span class="token punctuation">.</span><span class="token function">updateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>问：通过 updateInfo 来更新 userInfo 里面的数据信息，但是这段代码存在一些问题，你能修复这段代码吗？</p> <p>答：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> userInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;jack.ma&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">13</span><span class="token punctuation">,</span>
  <span class="token literal-property property">sex</span><span class="token operator">:</span><span class="token string">'male'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">updateInfo</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;pony.ma&quot;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">39</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'female'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="垃圾数据是如何自动回收的"><a href="#垃圾数据是如何自动回收的" class="header-anchor">#</a> 垃圾数据是如何自动回收的</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;极客邦&quot;</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;极客时间&quot;</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol><li>调用栈中的数据如何被销毁</li></ol> <p>答：当一个函数执行结束后，js引擎会通过向下移动<code>ESP指针</code>来销毁该函数保存在栈中的<code>执行上下文</code></p> <p><img src="/assets/img/8.cd604dfe.png" alt="esp"></p> <ol start="2"><li>堆中的数据如何被销毁
回收堆的垃圾数据，需要用到 JS 的<code>垃圾回收器</code></li></ol> <p>代际假说</p> <ul><li>大部分对象在内存中存活时间很短</li> <li>不死的对象会活的更久</li></ul> <p>因此，V8 把堆分为 <code>新生代</code> 和 <code>老生代</code>。</p> <ol><li>新生代中存放的是生存时间短的对象。新生区通常只支持 1～8M 的容量。新生代使用<code>副垃圾回收器</code></li> <li>老生代中存放的生存时间久的对象。老生区支持的容量就大很多了。老生代使用<code>主垃圾回收器</code></li></ol> <p>垃圾回收处理逻辑</p> <ol><li>新生代：把新生代空间对半划分为两个区域，一半是<code>对象区域</code>，一半是<code>空闲区域</code>; 新加入的对象都会存放到对象区域，当对象区域快被写满时，回收非存活的对象，再把存活的对象有序地放入空闲区域，对象区域与空闲区域进行角色翻转。经过两次垃圾回收依然还存活的对象，会被移动到老生区中。</li></ol> <img src="/assets/img/11.a4b2a65b.png" style="width:70%;"> <ol start="2"><li>老生代：</li></ol> <ul><li>标记 - 清除：回收不能到达的对象</li> <li>标记 - 整理：让所有存活的对象都向一端移动，不产生大量不连续的内存碎片</li></ul> <img src="data:image/png;base64,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" style="width:48%;"> <img src="data:image/png;base64,UklGRnITAABXRUJQVlA4IGYTAABQywCdASp2BLkBPpFGnUylo6MioHi5YLASCWlu4XMvgPA+XfzqGj+qv9z7df8d4Y/ifyr9i/KLll9GeZv8k+0P4jzO/0/hv70f3n7XPkI/H/5h/i98Nmz9QX1Q+Zf6L/D/u3/l/RP1L+9fsAfzL+n/6r+y+2H+t8Jn7r/s/YH/mX9z/7X+C/KT6YP6j/x/678mfcT+if5T/x/5j4Cv5j/aP+h/fPbY9j/7neyn+0gdeQ7z7R82rjs75QUGCHefaPm1cdnfKCgwQ7z7R82rjs75QUGCHefaPm1cdnfKCgwQ7z7R82rjs75QUGCHefaPm1cdnfKCgwQ7z7R82rjs75QUGCHefaPm1cdnfKCgwQ7z7R82rjs7ckQCt3FAueyqNHfK9mK3QZcffRxVnCn4zigUqzhUT2/SJi8+0fNokmlYWiooFz2YrdCEzL3jh4rOFRPacv0kJmoM9Taiq/yHefaIBJT4OBQZOiU/195sbFolPefFhjvmrZaZjGiaSU9MK47O+UEHVR87W8+9B5D+vvNjYtEp7z4sMd81bLTMY0TSSnphXHZ3ygf1o4awXCIwHnVI6GnFWcBEuDizoaACHYjoc3xhsJT3n2hmMf3YwQmag0G/+NOKsaDDbJkag0G/4lRmSXsG/+NMq6U6ay0tEp6YVx152lBAbof4m+lrpMK1mkU4YUgyIOMwXkogr/EyWUGxjmdpQU1xofnx2dpzQHwGTLhEhyrjs75Pkq4687Sgg6qPna3nxUuo/uYGn0MztfThbxSZOYyxogOG04j/liJJgHWSTxIro0EWQPZojGb9sOMAxlRaeVRTo/HIVfxnM/TVFcANwXpWnzE9qIYOHH9UaesyKXv5uSnwfWy19XZs2StVx2dvcrVXVF/GhE+Wvq7Nmt5yF3IeY/FA/d//SbztgryromswHzcJe/nAid/WfK6i2j5tXG3bkas1BoN/s10Pqlg3/xKICJ1TrXQ37/pQVDCbk7PAr0cQZVKhe2t4bUnIu6DQAQ7EdHE9OdhwEwrVgTmgCrjs75GkK43fIQ7TJ/TVdhPITc3bj+wwgciKsUQWpcGo6O3gfIRCdD5J57IMpCgkvCEEktAZvAsKLdNKuO0q82tYQKEz0SYIny0tEpo7Sgg6qPl0UBynwcCglyCo+bVxu/J6JpJT4PrZa+rs2bJWq47O2xK0cr9Li2d4O+VwiQ9a395DxVIn1hy/8CgwQ7rXsvF7EdHE9Odhr9gpO3Nuh/BE17DGx6FcZxBVi6luzvlBPL90YRqDQb/WqfMAQ0G/+Kw6rvSa3QhJnM1wkTUGg3+86/WhfyHefDJaahLwOcVnCooFz2Yrb0nzklg3/xQ871AuezFJYrYy0tEp6YVx2lXm0ZS9+u5WquqL+Q7z7Dz/BJDwcCgydEp/r7zY2LRKe8+LDHfNWy0Pqo+P80E9IMaJT3nwu1yu+UlZ8bETvmrZaH1UfNq466LDSYaWtrulVwGooFz2TAMpyUnCooFer7Kodh4LJygKf+w7z7R8dHmLw0Glu5parM03/KO7zrQk3OzAx2d8oIOqj4/zQT0gxomklPTCuOzvlBB1UfO1vPvQeQ/r7zY2LRKe8+LDHe6Inyuoto+6HebGxaJT3nxYY75q2WmYxomklPTCuOzvlBB1UfH+aCekGNE0kp6YVx2d8oIOqj52t596DyH9febGxaJT3nw62DL404qzhT/3lwxQQmagz2hiNsVVnCooBL2YrdBVsGWdnfKCgjmpSk2Fz2Yrc3EzUGg2DC3c6k1uhCMAU2cFAVFAr42ng62j5tXHkD5QUGCHefaSNquOzvlBQYId59o+bVx2d8oKDBDvPtHzauOzvlBQYId59o+bVx2d8oKDBDvPtHxvvpyJmn9QwHefaPm1cdnfKCgwQ7z7R82rjs75QUGCHefaPm1cdmzZKHwyEfeOsQOT8s5Ez4k6paW9YrzvlWu+ahaCLDJurUPZr79HE7MdnfKCgwQ7z7R82rjs75QUGCHefaPm1cdnfI0hV1NBWb/wuPC6I15GwnWqkKAmK5FVMBQA9jJ4KAskiojDyYmhXEBitATyVZ9ygv7R82rjs75QUGCHefaPm1cdnfKCgwQ7z7R82h0dCaOMFRPAf3Q9pDyBQYId59o+bVx2d8oKDBDvPtHzauOzvlBQYId59o+bVx2d8oKC9AAA/v+H6AAAAAAAAZcbcKuirkED4s2AJfzi/dXiybK1/wJEolo6o8y/yrxbIcbYIZQzU1SDl1G2jeL6/Dg8a6wguojyd7VBu3fkZ0Ff8AY+EpGvfFgRtCo09gPN3NbVc3adjKhJGohaRKZxKX6Ogd01BzYOg6Mq1BpKAAARDMjgIAB0js5nA3AdfnNkgjKFJYPfPSWFIkXwrCbGbcuplqp8ae6iSmxarhiP710D+EmCjg2x3AnM2fM+hDVSGP//sWr5r3nk1YlTbQD7+C3eL1nhigHzsqM5RbkaA9cBEr9tOsSrIeWTpxlWMET/KtuVmi6pmDUd7TfG3qfxWBhTlnVvweI5zJRIEbJTdJ/5OIyb2ZncYDZ0WYDUbKOKG/3Fxz1EqI/Hi76ifFxddv1/WhLUrms5v8kfqLAGrjync6tx59kzl7dUix/NqTERuVJacVGylyQUx0rC+A+uGvwtU7ZTvBNQmjupiAdxD4R+RaZwE4wWVs2PowRVTfe3aBD+gpU7Wwb5qQ1hJoyR/hBQMSNk59M/5oqXT90X+joMya9ZuksBsBExCvmJ12HL3AC9Yy57Vvm6h9efXkjDYfn9S0VoBdQ+bRnQwyyR5yWTsqe523eL8urwftR4xRq/KqkfJ9tPwBsj2YcNIRsSDK1QQe6rNtEvhkd7IB6n0XcBsN4mooz/GIeuOBW7+XGwl28opXH1OOzkc+21YLN+HXXmleoqy817e1mRQkvfRFn7I+8M7v+P07O1IEH6mbVYLR4z6TgNuKMSFLDasxdhPWzLZFJq1PfeGyOTElsLZXYD35HBTbaNRNMvAJkSS5zGSWZ018GFs0yCyv95ovJ03ADYRfsPGcwuU91sE/pvz6wiROVPRmYhcnkjLsDa0NZCnBZ+m2khtBna1q5tdRjfGrz1bkLpKBFwrAkTqf803vw3Tlght42c+KKh+dj1ReuzMAimeei9eCkcTkLCb5rEOQuFjdBav3p3GY2HIBo9fh+Y5hnWx4JnW5Hb3UeY99m1LyG7I2jhAYMQbKsuhxjGgvzkbcOqmNg1EknmG7U5PgjBwQt+5jL59UNPNvBiWlzskcIVnrsXUvWGNOhm917Z3CGx6gZDc25tDnGTPPZNyUIcai+HaeOzdJHS9sgupTsBopt7GJ2f1/a3vLbkqWk/6V/yvxoBXHGDSPaMOnV1To41HxVMRAELXNfkuhMLM/WKHmTAIwoo9tM0cdt13noiz/wxT7Lf+pG/V+/GqSKZyeeEMJ108auGNeUjWqnsF2CWW5rxHo3M/h6ekwgs0113/Qbaoitxno6Q2JTtz8K4GaJIBCYZ7syG/RCKOEUX5ZFMJu7GB+4zME5x/RHZxVxe8eg4dclJsjs4MHv3xqO/vB2/w6208kSdMftUAbR98/QOZtrnTM7PdAlXmSbG+nKYhj5ZHwq5VL0GOT/m68rwRMrIEgc+6eMVka6Uh8rmIrkJNVOuvV3Sh0+vYtfE+S8jcWZZlVoL5lOtqjY2X7/BPGTrG9xJAIaUgnu3ddg5R+QVGABgLbbA2pqfnsq9CTKjYQQ+9JgyH/5/AphRLui2Thw/i2hGBRIb8t6sX7zUdsYZe5lOfDMJXW9X+hzzGUnamhliKa+B7a73NYcDjMTRGzVNmzGD7agPdR3lNpHva4D3pFG5CGsWESeAxRr1YC+HuVehiQABdP2gz2MmWuIvGZyAyroSO+jkeS7JhALNI2dxIfinR6dmtjv+51oy40JRhOqfTlwi20RE/xAzMjZJi8bHT9+ioqXgEbPL2PFjh5laGY65EunyubhHAIDis6AEru21vZ5I9hxloc7ndTpL6A5wXO6LRbm2LyY64ytqrEjMXSuxo8Ix8zYlnx1ePu/8J9eVfbtvFVPSSNG69j6aqTjEFDyXYawqjD+2rl/6UU/nK4yLMuS8tybA2gew6fuqYsgiZGRRGgBlKXJ2SYHtIOcAXEbjvgGnIOvW8dP+OKsBP1pvs1rPsjDet40eqyIrPRIThpoLyXEjGenAGOJUqmpVFpGK/raeFwgoxxzP3il4kTJ5QvraZ9zryOCwdkdOMjroYft2t9lQe+NzSQbdRTmiXkwQ/6qFyR+o5Jj7vgKPSY7yqZoS5Y4FNAXWvPZ3JoZZW7+hZ6PVf9EzYIX83rlGIjuJJ7mxXENyHJ0qOppJoWZGaXN/UZrd8ofHm8Ivi//oEXdlNIEl2rTQ3qY1Qxb0QVlnzAovod7vzHTnzzGL1BjCSbF7EUHorIMTN2+8W9kTJRojRO6sG6eG9r7pJ/zMpS9Lr/Q0VhgZPnPFQBfjjfPvYQ/VPZutgSrSfUsICLwaXto7xdR9/+DEM77lvfSPSknGPVfZolQH1Q4mxSlrfEYF5KOzf8RqaNaeljBMSi5EuvQ3mLwp83vu7yWh3ISvd1rHdsCwo6FW7Swq1ZOFPlXRaeOWlYK1bQIb4mn4YnhvfQKgup3kLYUxdf/bgGqLQt+0taXzfbRds8RK4YO41gYErzqtnCtCgzH6tr7/+Qx9W9flpFRKdp8+dPFqZC8Y6zs7/jnyXT0MqHFTfzF2kwws4IoGDnwLFlHbEFNu94H84gWzjAwr2yLXfJ9fJIeu2my21iVVdHu0OgZ/u0q3S3CWC7I4jVVWhAi6c8+HqKY2Jhm3yrc6eeBINnK+Al8yKcS+fvscvkb2ZTXvbx2U6z3O//Lmp/8nc4/2zXoewIKDAJRmUEECRBbdXhKpgjsaTN7niMCS34IOYCLbblXDAO+qlc+a80PoeBmFZBuEMKkIVDCJ7r01QLygY+RTZcJ84+waipcn8AmHT9ClkkjCFB6n/VoPODI6JGfDUm1ArJSrZ5fJpTNdG98kx+BP6OrhFB3aeOAZcDAAFOpp1+yVKLcoSwQSSDW5ndXia157ybEeGccOjTLsSoVWKvzErMf6xh7B4EezBZQMR+konGlDulcGixxehi43mHjmuHL0L7s4GxHyAPwEYMjg1YdynasBsNquFZRQwAAPrAA326PO0yssYgrkJURpM8vGMLK7Ku7NGltdgV3rGCbn4ewbM7pmnv4SSZ+guKN2rIxBb2tnqi1iARl4p00n4CTJWfgb1Gp/9g62lxXovCpzIk8ooqEQ5nCg0CYEvpO4VzyJZt4T3ac7kFQXv7sAAAAAE1p9EcGFA9XADn/i2EIAAFEy3KoE7wbk5PmrVVdXLfpuOG1KFoFzV1yjlsZYpY/TT8YQbQja2wbwOXv+Z627TVCWJF95gVuEsuHx7nO81mjdiVogDyKgUVC0mjSLHRJCDh5P7AIbp78nvGZd4z5iNlPSiZOQEMkCUW7YeLYXJPwaWUYfehELCbBXT+2tLBBdgqwO04XyWfGWzcZ91o+jfNr0Yuz7Uk11jZ+5UC1sEAFL4wZfV368EAGoSOn7ZEN52zOfucRsNGbDx+3es23mYhwRRcmZtgRsGH3gX7Fj4HOu3svr+TDKwnzzVGAVae3qfHHolv721LDWPMjPei+uoXfIMEGtElYyBYycd5oi0uR+g+JpmnRAv90ncZoIlOvXv13nkEOu6cxKxD9GKHgrixdMtqO3nsCfjkTcO4F7y8+VtOFeEywy7v9PeD0GSY7syfcIhIG/3j5BRqAvPMZUTOE2KX5WTrGHyWwxk2mCeMG/144JXNAP5CffLHoLInUi+jPG5WIqiniYDQ9r+W4ejczeWOGKX2eZfHC4KzJmyltkn9zRTYCUg0O6WK335rW/SMOVnFHUAADwv1YQjMuVbvZPTxIU5k2lVE+yaz4ZUtxY2kTyos0/vTAChQuCb+9K9vou0391Rpc2e87D064GUJ8GJwnXy7IiYBB30oFG8TItW23TMzhnMpT6TTL0mrk+5TK+X318ifP5J6Ns/RHcJ2G33lqt3DXVk/1a2KFbbyg3LIrH6bwBM/tFpIxnrDquN7weaFtPsuwn0OHgfseeb0TGABpEgUnpBUqkGkwP/ppdtA12tW9/MaHngojg2qsi/rOcMZuWOPeqrVDMIJFLpEIMjvWdgZ/aFxvphWBTuwyo2s3VBFWcQH2GGKUIxEjbY2C32Q9nvTCtEeJ8ClUIvFMEyu7xBUdaoNNB+HjgflxRrVz1LrsV2ueMUeD+7KhxzGC5AGzxgOhXonKxV/PHEcQNRqOfsInEWraD3cYv64agO96KFwcnisHVi5bE3r+vIYyULfEJq4WIUXHQtNUf6+ZDC840Qrbelx0OkOV5rCZYvYc2jiZrxDdG3y3gwp7Co+4H8dhuIgKUTx2fYDEwrRCXCs8JJCndTTPmEXM7dhaXpc3guQRSLbl+RnFKN4SzpZuSVgg08C8J+j+Wkj56iXo27cHQxrKeXIr/6ywiTRuPbL5J5FBagn+qFpLrq7dRmVCPk0DthaCNT4zK3Rxf5BdoZKBic+cPK4iSA0SRVOqMf8OJ+JlEAZyhatAqUAAItk6fWsMAAAAAAAAA" style="width:48%;"> <h2 id="描述一下-v8-执行一段js代码的过程"><a href="#描述一下-v8-执行一段js代码的过程" class="header-anchor">#</a> 描述一下 V8 执行一段JS代码的过程</h2> <p>编译型语言和解释型语言</p> <ol><li>编译型语言: 在程序执行之前，需要经过编译器的编译过程，并且编译之后会直接保留机器能读懂的<code>二进制文件</code>，这样每次运行程序时，都可以直接运行该二进制文件，而不需要再次重新编译了。比如 C/C++、GO 等都是编译型语言。</li> <li>解释型语言: 在每次运行时都需要通过解释器对程序进行动态解释和执行。比如 Python、JAVA、JavaScript 等都属于解释型语言。</li></ol> <p><img src="/assets/img/12.1a689018.png" alt=""></p> <h3 id="v8如何执行一段代码"><a href="#v8如何执行一段代码" class="header-anchor">#</a> v8如何执行一段代码</h3> <p><img src="/assets/img/13.d88dd23a.png" alt="v8"></p> <ol><li>生成AST抽象语法树和执行上下文。通过<code>词法分析</code> -&gt; <code>语法分析</code></li> <li>生成字节码。字节码就是介于 AST 和机器码之间的一种代码；字节码需要通过解释器将其转换为机器码后才能执行。</li></ol> <p><img src="/assets/img/14.ddb79fc7.png" alt="code"></p> <p>机器码所占用的空间远远超过了字节码，所以<code>使用字节码可以减少系统的内存使用</code>。</p> <ol start="3"><li>执行代码。在执行字节码的过程中，如果发现有热点代码（HotSpot），比如一段代码被重复执行多次，这种就称为<code>热点代码</code>。把热点的字节码转换为机器码，并把转换后的机器码保存起来，以备下次使用</li></ol> <p><img src="/assets/img/15.7762f224.png" alt="v8"></p> <p>总结：V8 依据 JavaScript 代码生成 AST 和执行上下文，再基于 AST 生成字节码，然后通过解释器执行字节码，通过编译器来优化编译字节码。</p> <h2 id="考一考-3"><a href="#考一考-3" class="header-anchor">#</a> 考一考</h2> <p>问：如何理解 V8 执行时间越久，执行效率越高</p> <p>答：因为更多的代码成为热点代码之后，转为了机器码来执行</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/9/2021, 2:39:40 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/basic/code_write/promise.html" class="prev">
        手写Promise
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.e8c3aa62.js" defer></script><script src="/assets/js/2.1d5e0d04.js" defer></script><script src="/assets/js/4.c29c9b60.js" defer></script>
  </body>
</html>
